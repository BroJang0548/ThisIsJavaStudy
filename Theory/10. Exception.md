# ğŸ“š ì˜ˆì™¸ ì²˜ë¦¬

## ì˜ˆì™¸ ì²˜ë¦¬ì˜ ê¸°ë³¸ ê°œë… ğŸ“–

### 1. ì˜ˆì™¸(Exception)ì˜ ì •ì˜

- **ì •ì˜**: í”„ë¡œê·¸ë¨ ì‹¤í–‰ ì¤‘ ë°œìƒí•˜ëŠ” ë¹„ì •ìƒì ì¸ ìƒí™©
- **ëª©ì **: í”„ë¡œê·¸ë¨ì˜ ë¹„ì •ìƒ ì¢…ë£Œë¥¼ ë°©ì§€í•˜ê³  ì •ìƒì ì¸ ì‹¤í–‰ ìƒíƒœë¥¼ ìœ ì§€
- **íŠ¹ì§•**:
    - í”„ë¡œê·¸ë¨ ì‹¤í–‰ ì¤‘ ë™ì ìœ¼ë¡œ ë°œìƒ
    - ì²˜ë¦¬ë˜ì§€ ì•Šìœ¼ë©´ í”„ë¡œê·¸ë¨ ì¢…ë£Œ
    - ì˜ˆì™¸ ì²˜ë¦¬ë¥¼ í†µí•´ ì •ìƒ ì‹¤í–‰ íë¦„ ìœ ì§€ ê°€ëŠ¥

### 2. ì˜ˆì™¸ì˜ ì¢…ë¥˜ì™€ íŠ¹ì§•

### 1. Checked Exception

- **ì •ì˜**: ì»´íŒŒì¼ëŸ¬ê°€ ì²´í¬í•˜ëŠ” ì˜ˆì™¸
- **íŠ¹ì§•**:
    - ë°˜ë“œì‹œ ì˜ˆì™¸ ì²˜ë¦¬ í•„ìš”
    - ë©”ì„œë“œ ì„ ì–¸ë¶€ì— throws ëª…ì‹œ í•„ìš”
    - íŠ¸ëœì­ì…˜ ë¡¤ë°± ë°œìƒí•˜ì§€ ì•ŠìŒ
- **ì£¼ìš” ì˜ˆì™¸**:
    
    ```java
    - IOException
    - SQLException
    - ClassNotFoundException
    - InterruptedException
    
    ```
    

### 2. Unchecked Exception (Runtime Exception)

- **ì •ì˜**: ëŸ°íƒ€ì„ì— ë°œìƒí•˜ëŠ” ì˜ˆì™¸
- **íŠ¹ì§•**:
    - ëª…ì‹œì ì¸ ì˜ˆì™¸ ì²˜ë¦¬ ë¶ˆí•„ìš”
    - ë©”ì„œë“œ ì„ ì–¸ë¶€ì— throws ìƒëµ ê°€ëŠ¥
    - íŠ¸ëœì­ì…˜ ë¡¤ë°± ë°œìƒ
- **ì£¼ìš” ì˜ˆì™¸**:
    
    ```java
    - NullPointerException
    - IllegalArgumentException
    - IndexOutOfBoundsException
    - ConcurrentModificationException
    
    ```
    

### 3. ì˜ˆì™¸ ì²˜ë¦¬ì˜ ê¸°ë³¸ ì›ì¹™

1. **ê°€ëŠ¥í•œ ë¹¨ë¦¬ ì˜ˆì™¸ ê°ì§€**
    
    ```java
    public void processUser(User user) {
        // ë©”ì„œë“œ ì‹œì‘ ì‹œ ì¦‰ì‹œ ê²€ì¦
        if (user == null) {
            throw new IllegalArgumentException("User cannot be null");
        }
        // ì´í›„ ë¡œì§ ì§„í–‰
    }
    
    ```
    
2. **ì ì ˆí•œ ë²”ìœ„ì—ì„œ ì˜ˆì™¸ ì²˜ë¦¬**
    
    ```java
    public void processData() {
        try {
            // ìµœì†Œí•œì˜ ì½”ë“œë§Œ try ë¸”ë¡ì— í¬í•¨
            readDataFromFile();
        } catch (IOException e) {
            // êµ¬ì²´ì ì¸ ì˜ˆì™¸ ì²˜ë¦¬
            handleIOException(e);
        }
    }
    
    ```
    
3. **ì˜ˆì™¸ì˜ ì¶”ìƒí™” ë ˆë²¨ ìœ ì§€**
    
    ```java
    public class DataAccessException extends RuntimeException {
        // í•˜ìœ„ ë ˆë²¨ ì˜ˆì™¸ë¥¼ ìƒìœ„ ë ˆë²¨ì—ì„œ ì ì ˆíˆ ì¶”ìƒí™”
        public DataAccessException(String message, Throwable cause) {
            super(message, cause);
        }
    }
    
    ```
    

### 4. ì˜ˆì™¸ ì²˜ë¦¬ ë©”ì»¤ë‹ˆì¦˜ì˜ ë™ì‘ ì›ë¦¬

1. **ì˜ˆì™¸ ë°œìƒê³¼ ì „íŒŒ**
    
    ```java
    public void methodC() throws Exception {
        throw new Exception("Error in C");
    }
    
    public void methodB() throws Exception {
        methodC(); // ì˜ˆì™¸ ì „íŒŒ
    }
    
    public void methodA() {
        try {
            methodB();
        } catch (Exception e) {
            // ìµœì¢…ì ìœ¼ë¡œ ì—¬ê¸°ì„œ ì²˜ë¦¬
        }
    }
    
    ```
    
2. **ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤ ìƒì„±**
    - ì˜ˆì™¸ ë°œìƒ ì‹œì ì˜ í˜¸ì¶œ ìŠ¤íƒ ì •ë³´ ì €ì¥
    - ë””ë²„ê¹…ì„ ìœ„í•œ ì¤‘ìš”í•œ ì •ë³´ ì œê³µ
    
    ```java
    try {
        // ì˜ˆì™¸ ë°œìƒ ì½”ë“œ
    } catch (Exception e) {
        // ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤ ë¶„ì„
        StackTraceElement[] stack = e.getStackTrace();
        for (StackTraceElement element : stack) {
            log.debug("Class: {}, Method: {}, Line: {}",
                element.getClassName(),
                element.getMethodName(),
                element.getLineNumber());
        }
    }
    
    ```
    

### 5. ì˜ˆì™¸ ì²˜ë¦¬ ë¹„ìš©ê³¼ ì„±ëŠ¥ íŠ¹ì„±

1. **ì˜ˆì™¸ ìƒì„± ë¹„ìš©**
    - ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤ ìˆ˜ì§‘: ë†’ì€ ë¹„ìš©
    - ê°ì²´ ìƒì„±: ì¼ë°˜ ê°ì²´ë³´ë‹¤ ë†’ì€ ë¹„ìš©
    
    ```java
    // ë¹„ìš©ì´ ë†’ì€ ë°©ì‹
    try {
        value = map.get(key);
        if (value == null) {
            throw new NotFoundException();
        }
    } catch (NotFoundException e) {
        // ì²˜ë¦¬
    }
    
    // ê°œì„ ëœ ë°©ì‹
    value = map.get(key);
    if (value == null) {
        // ì˜ˆì™¸ ì—†ì´ ì²˜ë¦¬
        handleMissingValue();
    }
    
    ```
    
2. **ì„±ëŠ¥ ì˜í–¥**
    - try-catch ë¸”ë¡: JVM ìµœì í™” ì œí•œ
    - ì˜ˆì™¸ ì²˜ë¦¬ ê²½ë¡œ: ì¼ë°˜ ì‹¤í–‰ ê²½ë¡œë³´ë‹¤ ëŠë¦¼
    
    ```java
    // ì„±ëŠ¥ì— ë¯¼ê°í•œ ì½”ë“œì˜ ê²½ìš°
    public Object getValue(String key) {
        // ì˜ˆì™¸ ì²˜ë¦¬ ëŒ€ì‹  null ì²´í¬ ì‚¬ìš©
        return cache.containsKey(key) ? cache.get(key) : null;
    }
    
    ```
    

## 1. Java 7 ì´í›„ ì¶”ê°€ëœ ì˜ˆì™¸ ì²˜ë¦¬ ê¸°ëŠ¥ ğŸ†•

### 1.1 Multi-catch ë¬¸ë²• ê°œì„ 

```java
try {
    // ì˜ˆì™¸ ë°œìƒ ê°€ëŠ¥ ì½”ë“œ
} catch (FileNotFoundException | SQLException e) {
    // ê³µí†µ ì˜ˆì™¸ ì²˜ë¦¬
    e.printStackTrace();
}

```

### 1.2 try-with-resources ê°œì„  (Java 9+)

```java
// Java 9 ì´ì „
try (BufferedReader br = new BufferedReader(new FileReader("test.txt"))) {
    // ë¦¬ì†ŒìŠ¤ ì‚¬ìš©
}

// Java 9 ì´í›„ - ì™¸ë¶€ì—ì„œ ì„ ì–¸ëœ ë¦¬ì†ŒìŠ¤ ì‚¬ìš© ê°€ëŠ¥
BufferedReader br = new BufferedReader(new FileReader("test.txt"));
try (br) {
    // ë¦¬ì†ŒìŠ¤ ì‚¬ìš©
}

```

### 1.3 Effectively Final ë³€ìˆ˜ (Java 9+)

```java
BufferedReader br = new BufferedReader(new FileReader("test.txt"));
PrintWriter pw = new PrintWriter(new FileWriter("output.txt"));
// íš¨ê³¼ì ìœ¼ë¡œ finalì¸ ë¦¬ì†ŒìŠ¤ ì‚¬ìš©
try (br; pw) {
    // ë¦¬ì†ŒìŠ¤ ì‚¬ìš©
}

```

## 2. ì˜ˆì™¸ ì²˜ë¦¬ì˜ ëª¨ë²” ì‚¬ë¡€ (Best Practices) ğŸ’¡

### 2.1 ì˜ˆì™¸ ê³„ì¸µ êµ¬ì¡° ì„¤ê³„

```java
// ê¸°ë³¸ ë¹„ì¦ˆë‹ˆìŠ¤ ì˜ˆì™¸
public abstract class BusinessException extends RuntimeException {
    public BusinessException(String message) {
        super(message);
    }
}

// êµ¬ì²´ì ì¸ ë¹„ì¦ˆë‹ˆìŠ¤ ì˜ˆì™¸
public class InsufficientBalanceException extends BusinessException {
    private final BigDecimal requested;
    private final BigDecimal available;

    public InsufficientBalanceException(BigDecimal requested, BigDecimal available) {
        super(String.format("ì”ì•¡ ë¶€ì¡± (ìš”ì²­: %s, ê°€ëŠ¥: %s)", requested, available));
        this.requested = requested;
        this.available = available;
    }
}

```

### 2.2 ì˜ˆì™¸ ë˜í•‘ (Exception Wrapping)

```java
try {
    // ë°ì´í„°ë² ì´ìŠ¤ ì‘ì—…
} catch (SQLException e) {
    throw new DatabaseException("ë°ì´í„°ë² ì´ìŠ¤ ì‘ì—… ì‹¤íŒ¨", e);
} catch (IOException e) {
    throw new SystemException("íŒŒì¼ ì²˜ë¦¬ ì‹¤íŒ¨", e);
}

```

### 2.3 Java 17ì˜ í–¥ìƒëœ NPE ë©”ì‹œì§€

```java
record Person(String name) {}
Person person = null;
// Java 17ì—ì„œëŠ” ë” ëª…í™•í•œ NPE ë©”ì‹œì§€ ì œê³µ
person.name(); // NullPointerException: Cannot invoke "Person.name()" because "person" is null

```

## 3. ìƒˆë¡œìš´ ì˜ˆì™¸ ì²˜ë¦¬ íŒ¨í„´ ğŸ¯

### 3.1 Optionalê³¼ ì˜ˆì™¸ ì²˜ë¦¬ ê²°í•©

```java
public Optional<User> findUser(String id) {
    try {
        return Optional.of(userRepository.findById(id));
    } catch (Exception e) {
        return Optional.empty();
    }
}

// ì‚¬ìš©
findUser("userId")
    .orElseThrow(() -> new UserNotFoundException("ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."));

```

### 3.2 í•¨ìˆ˜í˜• ì˜ˆì™¸ ì²˜ë¦¬

```java
public interface ThrowingFunction<T, R, E extends Exception> {
    R apply(T t) throws E;
}

public static <T, R> Function<T, R> wrapper(ThrowingFunction<T, R, Exception> throwingFunction) {
    return t -> {
        try {
            return throwingFunction.apply(t);
        } catch (Exception e) {
            throw new RuntimeException(e);
        }
    };
}

```

### 3.3 ì˜ˆì™¸ ë¡œê¹… ê°œì„ 

```java
@Slf4j
public class ExceptionHandler {
    public void handleException(Exception e) {
        log.error("ì˜ˆì™¸ ë°œìƒ: {}", e.getMessage(), e);
        // êµ¬ì¡°í™”ëœ ë¡œê¹…
        MDC.put("error_id", UUID.randomUUID().toString());
        MDC.put("error_type", e.getClass().getSimpleName());
    }
}

```

## 4. ë¦¬ì†ŒìŠ¤ ê´€ë¦¬ì˜ ìƒˆë¡œìš´ ë°©ë²• ğŸ”„

### 4.1 AutoCloseable ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„

```java
public class CustomResource implements AutoCloseable {
    private final String name;
    private boolean closed = false;

    public CustomResource(String name) {
        this.name = name;
    }

    public void doWork() {
        if (closed) {
            throw new IllegalStateException("ë¦¬ì†ŒìŠ¤ê°€ ì´ë¯¸ ë‹«í˜”ìŠµë‹ˆë‹¤.");
        }
        // ì‘ì—… ìˆ˜í–‰
    }

    @Override
    public void close() {
        if (!closed) {
            closed = true;
            // ë¦¬ì†ŒìŠ¤ ì •ë¦¬ ì‘ì—…
        }
    }
}

```

### 4.2 ë³µìˆ˜ ë¦¬ì†ŒìŠ¤ ê´€ë¦¬

```java
public void processFiles(String input, String output) {
    try (var reader = new BufferedReader(new FileReader(input));
         var writer = new BufferedWriter(new FileWriter(output))) {
        String line;
        while ((line = reader.readLine()) != null) {
            writer.write(line);
            writer.newLine();
        }
    }
}

```

## 5. ì˜ˆì™¸ ì²˜ë¦¬ ì„±ëŠ¥ ìµœì í™” âš¡

### 5.1 ì˜ˆì™¸ ìƒì„± ë¹„ìš© ìµœì†Œí™”

```java
// ë¹„ìš©ì´ í° ë°©ì‹
if (condition) {
    throw new CustomException("ì—ëŸ¬ ë©”ì‹œì§€: " + expensiveOperation());
}

// ìµœì í™”ëœ ë°©ì‹
if (condition) {
    throw new CustomException(() -> "ì—ëŸ¬ ë©”ì‹œì§€: " + expensiveOperation());
}

```

### 5.2 ì˜ˆì™¸ ìºì‹±

```java
public class CachedExceptions {
    private static final InvalidArgumentException CACHED_EXCEPTION =
        new InvalidArgumentException("ì˜ëª»ëœ ì¸ì");

    public static InvalidArgumentException invalidArgument() {
        return CACHED_EXCEPTION;
    }
}

```

## 6. í…ŒìŠ¤íŠ¸ì—ì„œì˜ ì˜ˆì™¸ ì²˜ë¦¬ ğŸ§ª

### 6.1 JUnit 5ë¥¼ ì‚¬ìš©í•œ ì˜ˆì™¸ í…ŒìŠ¤íŠ¸

```java
@Test
void shouldThrowException() {
    assertThrows(InsufficientBalanceException.class, () -> {
        account.withdraw(new BigDecimal("1000000"));
    });
}

@Test
void shouldThrowExceptionWithMessage() {
    InsufficientBalanceException exception = assertThrows(
        InsufficientBalanceException.class,
        () -> account.withdraw(new BigDecimal("1000000"))
    );

    assertEquals("ì”ì•¡ ë¶€ì¡±", exception.getMessage());
}

```

### 6.2 ì˜ˆì™¸ ì²´ì¸ í…ŒìŠ¤íŠ¸

```java
@Test
void shouldPreserveExceptionChain() {
    Exception exception = assertThrows(ServiceException.class,
        () -> service.doRiskyOperation());

    assertAll(
        () -> assertNotNull(exception.getCause()),
        () -> assertTrue(exception.getCause() instanceof SQLException)
    );
}

```

## 7. ì‹¤ë¬´ ì‘ìš© ì‚¬ë¡€ ğŸ’¼

### 7.1 íŠ¸ëœì­ì…˜ ì²˜ë¦¬

```java
@Transactional
public void transferMoney(String fromAccount, String toAccount, BigDecimal amount) {
    try {
        accountService.withdraw(fromAccount, amount);
        accountService.deposit(toAccount, amount);
    } catch (InsufficientBalanceException e) {
        // íŠ¸ëœì­ì…˜ ìë™ ë¡¤ë°±
        throw new TransferFailedException("ì†¡ê¸ˆ ì‹¤íŒ¨: ì”ì•¡ ë¶€ì¡±", e);
    } catch (Exception e) {
        // ê¸°íƒ€ ì˜ˆì™¸ ì²˜ë¦¬
        throw new TransferFailedException("ì†¡ê¸ˆ ì‹¤íŒ¨: ì‹œìŠ¤í…œ ì˜¤ë¥˜", e);
    }
}

```

### 7.2 ë¹„ë™ê¸° ì˜ˆì™¸ ì²˜ë¦¬

```java
@Async
public CompletableFuture<TransactionResult> processTransactionAsync(
        Transaction transaction) {
    return CompletableFuture.supplyAsync(() -> {
        try {
            return transactionProcessor.process(transaction);
        } catch (Exception e) {
            throw new AsyncTransactionException("ë¹„ë™ê¸° ì²˜ë¦¬ ì‹¤íŒ¨", e);
        }
    });
}

```

## 8. ì£¼ì˜ ì‚¬í•­ ë° íŒ âš ï¸

1. ì˜ˆì™¸ ì²˜ë¦¬ ë¹„ìš©
    - ì˜ˆì™¸ëŠ” ì„±ëŠ¥ ë¹„ìš©ì´ í¬ë¯€ë¡œ ë¡œì§ ì œì–´ìš©ìœ¼ë¡œ ì‚¬ìš©í•˜ì§€ ì•Šê¸°
    - ì˜ˆì¸¡ ê°€ëŠ¥í•œ ìƒí™©ì€ ì¡°ê±´ë¬¸ìœ¼ë¡œ ì²˜ë¦¬
2. ì˜ˆì™¸ ê³„ì¸µ êµ¬ì¡°
    - ë„ˆë¬´ ê¹Šì€ ê³„ì¸µ êµ¬ì¡° í”¼í•˜ê¸°
    - ì˜ë¯¸ ìˆëŠ” ê·¸ë£¹í™” ì‚¬ìš©
3. ë©”ì‹œì§€ ì‘ì„±
    - êµ¬ì²´ì ì´ê³  í–‰ë™ ê°€ëŠ¥í•œ ë©”ì‹œì§€ ì‘ì„±
    - ë””ë²„ê¹…ì— í•„ìš”í•œ ì •ë³´ í¬í•¨
4. ë¦¬ì†ŒìŠ¤ ê´€ë¦¬
    - AutoCloseable ì ê·¹ í™œìš©
    - ë¦¬ì†ŒìŠ¤ ëˆ„ìˆ˜ ë°©ì§€
5. ë¡œê¹… ì „ëµ
    - ì ì ˆí•œ ë¡œê·¸ ë ˆë²¨ ì‚¬ìš©
    - ì¤‘ìš” ì •ë³´ ë§ˆìŠ¤í‚¹ ì²˜ë¦¬

## 9. Java ë²„ì „ë³„ ì˜ˆì™¸ ì²˜ë¦¬ ì§„í™” ğŸ”„

### 9.1 Java 7 ì´í›„ ì£¼ìš” ë³€ê²½ì‚¬í•­

```java
// Java 7: Multi-catch
try {
    // ì½”ë“œ
} catch (IOException | SQLException e) {
    // ê³µí†µ ì²˜ë¦¬
}

// Java 9: í–¥ìƒëœ try-with-resources
FileReader reader = new FileReader("file.txt");
try (reader) { // ì™¸ë¶€ì—ì„œ ì„ ì–¸ëœ ë¦¬ì†ŒìŠ¤ ì‚¬ìš© ê°€ëŠ¥
    // ì²˜ë¦¬
}

// Java 14+: í–¥ìƒëœ NullPointerException ë©”ì‹œì§€
person.getAddress().getZipCode(); // "Cannot invoke "Address.getZipCode()" because the return value of "Person.getAddress()" is null"

```

### 9.2 íŒ¨í„´ ë§¤ì¹­ê³¼ ì˜ˆì™¸ ì²˜ë¦¬ (Java 16+)

```java
try {
    // ì½”ë“œ
} catch (Exception e) {
    String message = switch (e) {
        case NullPointerException npe -> "ë„ ì°¸ì¡° ë°œìƒ: " + npe.getMessage();
        case NumberFormatException nfe -> "ìˆ«ì í˜•ì‹ ì˜¤ë¥˜: " + nfe.getMessage();
        case IllegalArgumentException iae
            when iae.getMessage().contains("invalid") ->
            "ì˜ëª»ëœ ì¸ì: " + iae.getMessage();
        default -> "ê¸°íƒ€ ì˜¤ë¥˜: " + e.getMessage();
    };
    log.error(message);
}

```

## 10. í˜„ëŒ€ì  ì˜ˆì™¸ ì²˜ë¦¬ íŒ¨í„´ ğŸŒŸ

### 10.1 í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë°ì—ì„œì˜ ì˜ˆì™¸ ì²˜ë¦¬

```java
// Either íƒ€ì…ì„ ì‚¬ìš©í•œ ì˜ˆì™¸ ì²˜ë¦¬
public sealed interface Either<L, R> {
    record Left<L, R>(L value) implements Either<L, R> {}
    record Right<L, R>(R value) implements Either<L, R> {}
}

public Either<Exception, Integer> divide(int a, int b) {
    try {
        return new Right<>(a / b);
    } catch (ArithmeticException e) {
        return new Left<>(e);
    }
}

// ì‚¬ìš© ì˜ˆ
divide(10, 2)
    .map(result -> result * 2)
    .fold(
        error -> handleError(error),
        success -> processResult(success)
    );

```

### 10.2 ë¹„ë™ê¸° ì˜ˆì™¸ ì²˜ë¦¬

```java
@Async
public CompletableFuture<TransactionResult> processAsync(Transaction tx) {
    return CompletableFuture
        .supplyAsync(() -> processTransaction(tx))
        .exceptionally(throwable -> {
            log.error("ë¹„ë™ê¸° ì²˜ë¦¬ ì‹¤íŒ¨", throwable);
            return TransactionResult.failure(throwable);
        })
        .thenApply(result -> {
            if (result.isSuccess()) {
                notifySuccess(result);
            }
            return result;
        });
}

```

## 11. ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ í™˜ê²½ì˜ ì˜ˆì™¸ ì²˜ë¦¬ ğŸŒ

### 11.1 ê¸€ë¡œë²Œ ì˜ˆì™¸ ì²˜ë¦¬

```java
@RestControllerAdvice
public class GlobalExceptionHandler {
    @ExceptionHandler(BusinessException.class)
    public ResponseEntity<ErrorResponse> handleBusinessException(
            BusinessException ex, WebRequest request) {
        ErrorResponse error = ErrorResponse.builder()
            .timestamp(LocalDateTime.now())
            .status(HttpStatus.BAD_REQUEST)
            .message(ex.getMessage())
            .path(request.getDescription(false))
            .build();

        return new ResponseEntity<>(error, HttpStatus.BAD_REQUEST);
    }

    @ExceptionHandler(CircuitBreakerException.class)
    public ResponseEntity<ErrorResponse> handleCircuitBreakerException(
            CircuitBreakerException ex) {
        // ì„œí‚· ë¸Œë ˆì´ì»¤ ì˜ˆì™¸ ì²˜ë¦¬
        return new ResponseEntity<>(
            new ErrorResponse("ì„œë¹„ìŠ¤ ì¼ì‹œì  ë¶ˆê°€ëŠ¥"),
            HttpStatus.SERVICE_UNAVAILABLE
        );
    }
}

```

### 11.2 ë¶„ì‚° ì¶”ì ì„ ìœ„í•œ ì˜ˆì™¸ ì²˜ë¦¬

```java
public class TracedBusinessException extends BusinessException {
    private final String traceId;

    public TracedBusinessException(String message, String traceId) {
        super(message);
        this.traceId = traceId;
    }

    @Override
    public String getMessage() {
        return String.format("[TraceId: %s] %s", traceId, super.getMessage());
    }
}

```

## 12. ë³´ì•ˆ ê´€ë ¨ ì˜ˆì™¸ ì²˜ë¦¬ ğŸ”’

### 12.1 ë¯¼ê°í•œ ì •ë³´ ì²˜ë¦¬

```java
public class SecureException extends RuntimeException {
    private static final String MASK = "********";
    private final String sensitiveData;

    public SecureException(String message, String sensitiveData) {
        super(message);
        this.sensitiveData = sensitiveData;
    }

    @Override
    public String toString() {
        return String.format("SecureException: %s [Data: %s]",
            getMessage(), MASK);
    }

    // ê¶Œí•œ ìˆëŠ” ë¡œê·¸ë§Œì„ ìœ„í•œ ë©”ì„œë“œ
    @Secured("ROLE_ADMIN")
    public String getSensitiveData() {
        return sensitiveData;
    }
}

```

### 12.2 ë³´ì•ˆ ë¡œê¹…

```java
public class SecureLogger {
    private static final Pattern CREDIT_CARD =
        Pattern.compile("\\\\d{4}-\\\\d{4}-\\\\d{4}-\\\\d{4}");
    private static final Pattern SSN =
        Pattern.compile("\\\\d{3}-\\\\d{2}-\\\\d{4}");

    public static String maskSensitiveData(String message) {
        String masked = CREDIT_CARD.matcher(message)
            .replaceAll("****-****-****-$4");
        return SSN.matcher(masked)
            .replaceAll("***-**-$3");
    }

    public static void logError(String message, Throwable t) {
        String secureMessage = maskSensitiveData(message);
        log.error(secureMessage, t);
    }
}

```

## 13. í…ŒìŠ¤íŠ¸ ê´€ë ¨ ì˜ˆì™¸ ì²˜ë¦¬ ğŸ§ª

### 13.1 JUnit 5 ì˜ˆì™¸ í…ŒìŠ¤íŠ¸

```java
@Test
void exceptionTesting() {
    // ê¸°ë³¸ ì˜ˆì™¸ í…ŒìŠ¤íŠ¸
    assertThrows(BusinessException.class, () -> {
        service.riskyOperation();
    });

    // ì˜ˆì™¸ ë©”ì‹œì§€ ê²€ì¦
    BusinessException exception = assertThrows(
        BusinessException.class,
        () -> service.riskyOperation()
    );
    assertTrue(exception.getMessage().contains("ê¸°ëŒ€í•˜ëŠ” ë©”ì‹œì§€"));

    // ì˜ˆì™¸ ë¯¸ë°œìƒ ê²€ì¦
    assertDoesNotThrow(() -> {
        service.safeOperation();
    });
}

```

### 13.2 ì˜ˆì™¸ ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸

```java
@Test
void exceptionScenarioTesting() {
    // given
    when(repository.findById(anyString()))
        .thenThrow(new NotFoundException("ì—”í‹°í‹° ì—†ìŒ"));

    // when & then
    assertAll(
        () -> assertThrows(NotFoundException.class,
            () -> service.findEntity("id")),
        () -> verify(errorHandler).handleError(any())
    );
}

```
